:: Widgets Tentacles [widget]
<<widget "tentaclestart">><<nobr>>
<<set $enemyarousalmax to 10000>>

<<set $alltentacles to []>>

/* Ideally tentacleno would be a widget argument and everything would just check $alltentacles.length */
<<for $tentacleindex to 0; $tentacleindex lt $tentacleno; $tentacleindex++>>
	<<run $alltentacles.push({ name: $tentaclenames[$tentacleindex], health: $tentaclehealth, head: 0, shaft: 0 })>>
<</for>>

<</nobr>><</widget>>

<<widget "tentacles">><<nobr>>

<<for $tentacleindex to 0; $tentacleindex lt $tentacleno; $tentacleindex++>>
	<<tentacleact>><br>
<</for>>

<<for $tentacleindex to 0; $tentacleindex lt $tentacleno; $tentacleindex++>>
	<<set $alltentacles[$tentacleindex].health -= 0.2>>
<</for>>

<<if $panicattacks gte 1 and $panicviolence is 0 and $panicparalysis is 0 and $controlled is 0>>
	<<set $rng to random(1, 100)>>
	<<if $rng is 100>>
	<<set $panicparalysis to 10>>
	<</if>>
<</if>>

<<if $panicattacks gte 2 and $panicviolence is 0 and $panicparalysis is 0 and $controlled is 0>>
	<<set $rng to random(1, 100)>>
	<<if $rng is 100>>
	<<set $panicviolence to 3>>
	<</if>>
<</if>>

<<if $arousal gte 10000>>

<<orgasmpassage>>

<</if>>

<<set $seconds += 10>>
<<if $seconds gte 60>>
<<set $seconds to 0>>
<<pass 1>>
<</if>>

<br>
<</nobr>><</widget>>

<<widget "effectstentacles">><<nobr>>

<<effectspain>>
<<effectsorgasm>>
<<effectsdissociation>>

<<for $tentacleindex to 0; $tentacleindex lt $tentacleno; $tentacleindex++>>
	<<effectstentacle>>
<</for>>

<br><br>
<</nobr>><</widget>>

<<widget "actionstentacles">><<nobr>>

<<set $enemyarousal to $arousal>>

<<if $vorecreature is 0 and $swarmcount lte 0>>
	<<if $images is 1>><<timed 100ms>>
	<<combatimg>>
	<br>
	<</timed>><</if>>
<</if>>

<<actioncarry>>
<<actioncarrydrop>>

<<if $trance lte 0 and $dissociation lte 1 and $panicparalysis is 0 and $panicviolence is 0 and $orgasmdown lte 0 and $pain lt 100>>

<<if $leftarm is 0>>Your left arm is free.<br><</if>>
<<actionstentacleslefthand>>

<<if $rightarm is 0>>Your right arm is free.<br><</if>>
<<actionstentaclesrighthand>>

<<if $leftleg is 0 and $rightleg is 0>>
Your legs are free.<br>
<<elseif $leftleg is 0>>
Your left leg is free.<br>
<<elseif $rightleg is 0>>
Your right leg is free.<br>
<<elseif $leftleg is "grappled" and $rightleg is "grappled">>
Your legs are entangled and forced apart, leaving you less able to protect your <<genitalsstop>><br>
<</if>>
<<actionstentacleslegs>>

<<if $mouthstate is "tentacleentrance">>
	<<tentaclewarning "mouthentrance" `"The {0} tentacle threatens your mouth."`>>
<</if>>
<<if $mouthstate is "tentacleimminent">>
	<<tentaclewarning "mouthentrance" `"The {0} tentacle presses against your mouth."`>>
<</if>>
<<if $mouthstate is "tentacle">>
	<<tentaclewarning "mouthentrance" `"The {0} tentacle thrusts into your mouth."`>>
<</if>>
<<if $mouthstate is "tentacledeep">>
	<<tentaclewarning "mouthdeep" `"The {0} tentacle thrusts into your mouth, ejaculating down your throat."`>>
<</if>>
<<actionstentaclesmouth>>


<<if $vaginastate is "tentacleentrance">>
	<<tentaclewarning "vaginaentrance" `"The {0} tentacle threatens your <<pussystop>>"`>>
<</if>>
<<if $vaginastate is "tentacleimminent">>
	<<tentaclewarning "vaginaimminent" `"The {0} tentacle presses against your <<pussycomma>> about to penetrate."`>>
<</if>>
<<if $vaginastate is "tentacle">>
	<<tentaclewarning "vagina" `"The {0} tentacle thrusts into your <<pussystop>>"`>>
<</if>>
<<if $vaginastate is "tentacledeep">>
	<<tentaclewarning "vaginadeep" `"The {0} tentacle thrusts into your <<pussycomma>> ejaculating deep into your womb."`>>
<</if>>
<<if $vaginause is "tentaclerub">>
	<<tentaclewarning "vaginarub" `"The {0} tentacle runs between your thighs, pressing against your labia and continuing to your tummy."`>>
<</if>>
<<actionstentaclesvagina>>


<<if $penisstate is "tentacleentrance">>
	<<tentaclewarning "penisentrance" `"The {0} tentacle threatens your <<penisstop>>"`>>
<</if>>
<<if $penisstate is "tentacleimminent">>
	<<tentaclewarning "penisimminent" `"The {0} tentacle presses against your <<peniscomma>> about to engulf."`>>
<</if>>
<<if $penisstate is "tentacle">>
	<<tentaclewarning "penis" `"The {0} tentacle envelops and pounds your <<penisstop>>"`>>
<</if>>
<<if $penisstate is "tentacledeep">>
	<<tentaclewarning "penisdeep" `"The {0} tentacle envelops and pounds your <<penisstop>>"`>>
<</if>>
<<if $penisuse is "tentaclerub">>
	<<tentaclewarning "penisrub" `"The {0} tentacle runs between your thighs, coiling around your <<penis>> and pressing against your tummy."`>>
<</if>>
<<actionstentaclespenis>>


<<if $anusstate is "tentacleentrance">>
	<<tentaclewarning "anusentrance" `"The {0} tentacle threatens your <<bottomstop>>"`>>
<</if>>
<<if $anusstate is "tentacleimminent">>
	<<tentaclewarning "anusimminent" `"The {0} tentacle presses against your <<bottomcomma>> about to penetrate."`>>
<</if>>
<<if $anusstate is "tentacle">>
	<<tentaclewarning "anus" `"The {0} tentacle thrusts into your <<bottomstop>>"`>>
<</if>>
<<if $anusstate is "tentacledeep">>
	<<tentaclewarning "anusdeep" `"The {0} tentacle thrusts into your <<bottomcomma>> ejaculating deep into your bowels."`>>
<</if>>
<<actionstentaclesanus>>


<<actionstentaclesthighs>>


<<if $bottomuse is "tentaclerub">>
	<<tentaclewarning "bottomrub" `"The {0} tentacle rubs itself between your butt cheeks."`>>
<</if>>
<<actionstentaclesbottom>>


<<if $breastuse is "tentacle">>
	<<tentaclewarning "chest" `"The {0} tentacle rubs itself between your <<breastsstop>>"`>>
<</if>>
<<actionstentacleschest>>

<</if>>


<<combatstate>>
<<carryblock>>

<br>
<</nobr>><</widget>>

<<widget "tentaclewarning">><<nobr>>

/* Find the index of tentacle in given state (must exist!) */
<<set $tentacleindex to findTentacleHead($args[0])>>
/* Replace {0} with tentacle name, then print the message */
<<print String.format($args[1], $alltentacles[$tentacleindex].name)>>
<br>

<</nobr>><</widget>>

<<widget "actionstentacleschest">><<nobr>>

<<for $tentacleindex to 0; $tentacleindex lt $tentacleno; $tentacleindex++>>
	<<actionstentaclechest>>
<</for>>
<</nobr>><</widget>>


<<widget "actionstentaclesbottom">><<nobr>>

<<for $tentacleindex to 0; $tentacleindex lt $tentacleno; $tentacleindex++>>
	<<actionstentaclebottom>>
<</for>>
<</nobr>><</widget>>


<<widget "actionstentaclesthighs">><<nobr>>

<<for $tentacleindex to 0; $tentacleindex lt $tentacleno; $tentacleindex++>>
	<<actionstentaclethighs>>
<</for>>
<</nobr>><</widget>>


<<widget "actionstentaclesanus">><<nobr>>

<<for $tentacleindex to 0; $tentacleindex lt $tentacleno; $tentacleindex++>>
	<<actionstentacleanus>>
<</for>>
<br>
<</nobr>><</widget>>


<<widget "actionstentaclespenis">><<nobr>>

<<for $tentacleindex to 0; $tentacleindex lt $tentacleno; $tentacleindex++>>
	<<actionstentaclepenis>>
<</for>>
<</nobr>><</widget>>


<<widget "actionstentaclesvagina">><<nobr>>

<<for $tentacleindex to 0; $tentacleindex lt $tentacleno; $tentacleindex++>>
	<<actionstentaclevagina>>
<</for>>
<</nobr>><</widget>>


<<widget "actionstentaclesmouth">><<nobr>>

<<for $tentacleindex to 0; $tentacleindex lt $tentacleno; $tentacleindex++>>
	<<actionstentaclemouth>>
<</for>>
<</nobr>><</widget>>


<<widget "actionstentacleslegs">><<nobr>>

<<for $tentacleindex to 0; $tentacleindex lt $tentacleno; $tentacleindex++>>
	<<actionstentaclelegs>>
<</for>>

<</nobr>><</widget>>


<<widget "actionstentaclesrighthand">><<nobr>>

<<for $tentacleindex to 0; $tentacleindex lt $tentacleno; $tentacleindex++>>
	<<actionstentaclerighthand>>
<</for>>

<</nobr>><</widget>>


<<widget "actionstentacleslefthand">><<nobr>>

<<for $tentacleindex to 0; $tentacleindex lt $tentacleno; $tentacleindex++>>
	<<actionstentaclelefthand>>
<</for>>

<</nobr>><</widget>>

<<widget "upperslither">><<nobr>>

<<if $upperclothes isnot "naked">>
then <<slithers>> beneath your $upperclothes
<<else>>
then <<slithers>> across your bare skin
<</if>>

<</nobr>><</widget>>

<<widget "lowerslither">><<nobr>>

<<if $lowerclothes isnot "naked">>
then <<slithers>> beneath your $lowerclothes
<<else>>
then <<slithers>> across your bare skin
<</if>>

<</nobr>><</widget>>

<<widget "underslither">><<nobr>>

<<if $lowerclothes isnot "naked">>
	<<if $undertype isnot "naked" and $undertype isnot "chastity">>
	then <<slithers>> beneath your $lowerclothes and $underclothes
	<<elseif $undertype is "chastity">>
	then <<slithers>> beneath your $lowerclothes against your chastity belt
	<<else>>
	<</if>>
<<else>>
	<<if $undertype isnot "naked" and $undertype isnot "chastity">>
	then <<slithers>> beneath your $underclothes
	<<elseif $undertype is "chastity">>
	then <<slithers>> against your chastity belt
	<<else>>
	then <<slithers>> across your bare skin
	<</if>>
<</if>>

<</nobr>><</widget>>

<<widget "statetentacles">><<nobr>>

<<set $activetentacleno to $tentacleno>>
<<for _i to 0; _i lt $tentacleno; _i++>>
	<<if $alltentacles[_i].shaft is "finished">>
		<<set $activetentacleno -= 1>>
	<</if>>
<</for>>

<</nobr>><</widget>>
